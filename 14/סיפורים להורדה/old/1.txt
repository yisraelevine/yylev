<script>
    window.onload=function(){
    /// GLOBAL varibles ///
    var short_link;
    var long_link;
    var popup_link = "#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjY0NTkiLCJ0b2dnbGUiOmZhbHNlfQ%3D%3D";
    var btn;
    var button_in_container_global = document.getElementById("new_con_of_buttons");

    /// TAKING OUT ONLY THE ID ///
    var remove_part_of_link;
    var id_from_url;
    function funcUrl(the_url){
        // removing start
        remove_part_of_link=the_url.replace("https://drive.google.com/file/d/",'');
        remove_part_of_link=remove_part_of_link.replace("https://drive.google.com/open?id=", '');
        remove_part_of_link=remove_part_of_link.replace("https://drive.google.com/a/student.hartnell.edu/file/d/", '');
        remove_part_of_link=remove_part_of_link.replace("http://", '');
        // removing end
        remove_part_of_link=remove_part_of_link.replace("&authuser=0&usp=drive_link",'');
        remove_part_of_link=remove_part_of_link.replace("/view?usp=sharing",'');
        remove_part_of_link=remove_part_of_link.replace("/view?usp=share_link",'');
        remove_part_of_link=remove_part_of_link.replace("/view",'');
        id_from_url=remove_part_of_link.replace("/",'');
        return id_from_url;
    }
    /// ALL BUTTONS EVENT ///
    function funcAll(){
        btn = this;
    };
    /// NEW BUTTONs EVENT ///
    function funcNew(){
/*        // name
        document.getElementById("new_name_of_playing").getElementsByTagName("h2")[0].innerText = this.getElementsByClassName("elementor-button-text")[0].innerText;
        // setting short link
        short_link = "https://docs.google.com/uc?export=download&id=" + this.getAttribute("data-source");
        // setting long link
        long_link = "https://www.googleapis.com/drive/v3/files/" + this.getAttribute("data-source") + "?alt=media&key=AIzaSyD-BVI4FnT_uXH13PiaaOkD6dUYD868cc8";
        // setting download button to short link
        document.getElementById("new_download_btn").getElementsByClassName("elementor-button")[0].href = short_link;
        document.getElementById("new_download_btn").style.display = "block";
        // displaying the player element
        document.getElementById("new_con_player").style.display = "block";
        // setting player sources to short link and long link
        document.getElementById("new_player").children[0].src = short_link;
        document.getElementById("new_player").children[1].src = long_link;
        
        // setting css 
        // displaying the download button element
        document.getElementById("new_download_btn").style.display = "block";
        // displaying the player element
        document.getElementById("new_con_player").style.display = "block";
        button_in_container = button_in_container_global.getElementsByClassName("elementor-element");
        for(let i = 0; i < button_in_container.length; i++){
            button_in_container[i].children[0].style.backgroundColor = "#376381";
        }
        this.children[0].style.backgroundColor = "#244358";
    }
    // SETTING NEW BUTTONS ///
    var button_in_container = button_in_container_global.getElementsByClassName("elementor-widget-button");
    for(let i = 0; i < button_in_container.length; i++){
        //setting button
        button = button_in_container[i];
        // adding event listener to button
        button.addEventListener('mousedown', funcNew);
        // setting url
        url = funcUrl(button.getElementsByTagName("a")[0].href);
        // setting data-source attribute to id_from_url
        button.setAttribute("data-source", url);
        // removing the href attribute
        button.getElementsByTagName("a")[0].removeAttribute("href");*/
    }
//***********************************************************//
    /// SETTING ALL BUTTONS ///
    var container = document.getElementsByClassName("all_buttons_container");
    var button_in_container;
    var button;
    for(let i = 0; i < container.length; i++){
        button_in_container = container[i].getElementsByClassName("elementor-widget-button");
        for(let x = 0; x < button_in_container.length; x++){
            // setting button
            button = container[i].getElementsByClassName("elementor-widget-button")[x];
            // adding event listener to button
            button.addEventListener('mousedown', funcAll);
            // setting url
            url = funcUrl(button.getElementsByTagName("a")[0].href);
            button.setAttribute("data-source", url);
            button.getElementsByTagName("a")[0].href = popup_link;
        }
    }
    /// POPUP ///
    jQuery( document ).on( 'elementor/popup/show', () => {
        // name
        document.getElementById("StoryNameOnPopup").getElementsByTagName("h2")[0].innerText = btn.getElementsByClassName("elementor-button-text")[0].innerText;
        // short link
        short_link = "https://docs.google.com/uc?export=download&id=" + btn.getAttribute("data-source");
        // long link
        long_link = "https://www.googleapis.com/drive/v3/files/" + btn.getAttribute("data-source") + "?alt=media&key=AIzaSyD-BVI4FnT_uXH13PiaaOkD6dUYD868cc8";
        // player source
        document.getElementById("player").children[0].src = short_link;
        document.getElementById("player").children[1].src = long_link;
        // download button
        document.getElementsByClassName("elementor-location-popup")[0].getElementsByClassName("elementor-button")[0].href = short_link;
    });
}

</script>

